{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Meson: Debug yams-daemon",
      "type": "lldb",
      "request": "launch",
      "program": "${workspaceFolder}/${config:mesonbuild.buildFolder}/src/daemon/yams-daemon",
      "args": [
        "--log-level",
        "${input:yamsLogLevel}",
        "--foreground"
      ],
      "cwd": "${workspaceFolder}",
      "preLaunchTask": "meson: build",
      "env": {
        "YAMS_LOG_LEVEL": "${input:yamsLogLevel}",
        "ASAN_OPTIONS": "fast_unwind_on_malloc=0:strict_string_checks=1"
      },
      "envFile": "${workspaceFolder}/${config:mesonbuild.buildFolder}/meson-vscode.env",
      "stopAtEntry": false,
      "console": "integratedTerminal",
      "windows": {
        "type": "cppvsdbg",
        "program": "${workspaceFolder}\\${config:mesonbuild.buildFolder}\\src\\daemon\\yams-daemon.exe",
        "envFile": "${workspaceFolder}\\${config:mesonbuild.buildFolder}\\meson-vscode.env"
      }
    },
    {
      "name": "Meson: Debug yams-cli",
      "type": "lldb",
      "request": "launch",
      "program": "${workspaceFolder}/${config:mesonbuild.buildFolder}/tools/yams-cli/yams-cli",
      "args": [
        "${input:yamsCliArguments}"
      ],
      "cwd": "${workspaceFolder}",
      "preLaunchTask": "meson: build",
      "env": {
        "YAMS_LOG_LEVEL": "${input:yamsLogLevel}"
      },
      "envFile": "${workspaceFolder}/${config:mesonbuild.buildFolder}/meson-vscode.env",
      "stopAtEntry": false,
      "console": "integratedTerminal",
      "windows": {
        "type": "cppvsdbg",
        "program": "${workspaceFolder}\\${config:mesonbuild.buildFolder}\\tools\\yams-cli\\yams-cli.exe",
        "envFile": "${workspaceFolder}\\${config:mesonbuild.buildFolder}\\meson-vscode.env"
      }
    },
    {
      "name": "Meson: Attach to yams-daemon",
      "type": "lldb",
      "request": "attach",
      "pid": "${command:pickProcess}",
      "cwd": "${workspaceFolder}",
      "env": {
        "YAMS_LOG_LEVEL": "${input:yamsLogLevel}",
        "LSAN_OPTIONS": "use_tls=0:verbosity=1:log_threads=1"
      }
    }
  ],
  "inputs": [
    {
      "id": "yamsLogLevel",
      "type": "pickString",
      "description": "Log level when starting YAMS processes",
      "options": [
        "trace",
        "debug",
        "info",
        "warn",
        "error"
      ],
      "default": "info"
    },
    {
      "id": "yamsCliArguments",
      "type": "promptString",
      "description": "Arguments passed to yams-cli (leave empty to run without arguments)",
      "default": "status"
    }
  ]
}
